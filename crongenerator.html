<!DOCTYPE html>
<html lang="cs">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>CRON Generator</title>
<script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-gray-900 text-white p-8 flex flex-col min-h-screen">

<div class="flex justify-end mb-4">
    <select id="cron-lang-switcher" class="bg-gray-700 text-white p-2 rounded-md">
        <option value="cs">Čeština</option>
        <option value="en">English</option>
    </select>
</div>

<div class="flex-1 max-w-4xl mx-auto bg-gray-800 p-8 rounded-xl shadow-lg space-y-6">
    <h1 id="cron-title" class="text-3xl font-bold">CRON Generator</h1>

    <div class="bg-gray-700 p-4 rounded-md text-gray-300">
        <p id="label-star-description">* znamená "každou hodnotu" (např. každou minutu, každý den, každý měsíc...)</p>
    </div>

    <!-- Předpřipravené příklady -->
    <div>
        <label id="label-presets" class="block text-sm font-medium text-gray-400">Předpřipravené příklady</label>
        <select id="cron-presets" class="mt-1 block w-full px-3 py-2 bg-gray-700 border border-gray-600 rounded-md text-white">
            <option value="">-- vyber --</option>
            <option value="0 10 * * *">Každý den v 10:00</option>
            <option value="0 12 * * 0-4">Každý pracovní den v 12:00</option>
            <option value="0 8 * * 6">Každou neděli v 8:00</option>
            <option value="*/15 * * * *">Každých 15 minut</option>
            <option value="0 10 1 * *">První den v měsíci v 10:00</option>
            <option value="0 10 1,15 * *">1. a 15. den v měsíci v 10:00</option>
            <option value="59 11 1-7 * 2">První středa v měsíci v 11:59</option>
            <option value="0 12 * 10 2">Každá středa v říjnu ve 12:00</option>
            <option value="custom">Vlastní</option>
        </select>
    </div>

    <!-- CRON části s tooltipy -->
    <div class="grid grid-cols-1 md:grid-cols-5 gap-4">
        <div>
            <label id="label-minute" class="block text-sm font-medium text-gray-400">Minuta</label>
            <input type="text" id="cron-minute" placeholder="0-59 nebo *" class="mt-1 block w-full px-3 py-2 bg-gray-700 border border-gray-600 rounded-md text-white font-mono">
            <p class="text-red-500 text-xs mt-1 hidden" id="error-minute"></p>
        </div>
        <div>
            <label id="label-hour" class="block text-sm font-medium text-gray-400">Hodina</label>
            <input type="text" id="cron-hour" placeholder="0-23 nebo *" class="mt-1 block w-full px-3 py-2 bg-gray-700 border border-gray-600 rounded-md text-white font-mono">
            <p class="text-red-500 text-xs mt-1 hidden" id="error-hour"></p>
        </div>
        <div>
            <label id="label-day" class="block text-sm font-medium text-gray-400">Den v měsíci</label>
            <input type="text" id="cron-day" placeholder="1-31 nebo *" class="mt-1 block w-full px-3 py-2 bg-gray-700 border border-gray-600 rounded-md text-white font-mono">
            <p class="text-red-500 text-xs mt-1 hidden" id="error-day"></p>
        </div>
        <div>
            <label id="label-month" class="block text-sm font-medium text-gray-400">Měsíc</label>
            <input type="text" id="cron-month" placeholder="1-12 nebo *" class="mt-1 block w-full px-3 py-2 bg-gray-700 border border-gray-600 rounded-md text-white font-mono">
            <p class="text-red-500 text-xs mt-1 hidden" id="error-month"></p>
        </div>
        <div>
            <label id="label-weekday" class="block text-sm font-medium text-gray-400">Den v týdnu</label>
            <input type="text" id="cron-weekday" placeholder="0-6 (Ne-Po) nebo *" class="mt-1 block w-full px-3 py-2 bg-gray-700 border border-gray-600 rounded-md text-white font-mono">
            <p class="text-red-500 text-xs mt-1 hidden" id="error-weekday"></p>
        </div>
    </div>

    <div>
        <label id="label-message" class="block text-sm font-medium text-gray-400">Zpráva (| = nový řádek)</label>
        <textarea id="cron-message" rows="3" placeholder="Napiš zprávu..." class="mt-1 block w-full px-3 py-2 bg-gray-700 border border-gray-600 rounded-md text-white font-mono"></textarea>
    </div>

    <div class="flex gap-2">
        <div class="flex-1">
            <label id="label-output" class="block text-sm font-medium text-gray-400">Generovaný CRON výraz</label>
            <input type="text" id="cron-output" readonly class="mt-1 block w-full px-3 py-2 bg-gray-700 border border-gray-600 rounded-md text-white font-mono">
        </div>
        <button id="copy-cron" class="bg-green-600 px-3 py-2 rounded-md hover:bg-green-500 self-end">Kopírovat</button>
    </div>

    <div class="flex gap-2">
        <div class="flex-1">
            <label id="label-command" class="block text-sm font-medium text-gray-400">Připravený Discord příkaz</label>
            <textarea id="cron-command" rows="3" readonly class="mt-1 block w-full px-3 py-2 bg-gray-700 border border-gray-600 rounded-md text-white font-mono"></textarea>
        </div>
        <button id="copy-command" class="bg-blue-600 px-3 py-2 rounded-md hover:bg-blue-500 self-end">Kopírovat</button>
    </div>
</div>

<footer class="mt-8 text-center text-sm text-gray-500">
    <p>Vytvořeno 2025, autor Papiscze</p>
</footer>

<script>
const translations = {
    cs: {
        title: "CRON Generator",
        labelPreset: "Předpřipravené příklady",
        labelMinute: "Minuta",
        labelHour: "Hodina",
        labelDay: "Den v měsíci",
        labelMonth: "Měsíc",
        labelWeekday: "Den v týdnu",
        labelOutput: "Generovaný CRON výraz",
        labelMessage: "Zpráva (| = nový řádek)",
        labelCommand: "Připravený Discord příkaz",
        starDescription: "* znamená 'každou hodnotu' (např. každou minutu, každý den, každý měsíc...)",
        copyCron: "Kopírovat",
        copyCommand: "Kopírovat",
        errorText: "Chyba v datech",
        errorMsg: "Neplatná hodnota, zadejte číslo v rozsahu nebo *"
    },
    en: {
        title: "CRON Generator",
        labelPreset: "Preset Examples",
        labelMinute: "Minute",
        labelHour: "Hour",
        labelDay: "Day of Month",
        labelMonth: "Month",
        labelWeekday: "Day of Week",
        labelOutput: "Generated CRON Expression",
        labelMessage: "Message (| = new line)",
        labelCommand: "Prepared Discord Command",
        starDescription: "* means 'every value' (e.g., every minute, every day, every month...)",
        copyCron: "Copy",
        copyCommand: "Copy",
        errorText: "Error in data",
        errorMsg: "Invalid value, enter a number in range or *"
    }
};

const langSwitcher = document.getElementById('cron-lang-switcher');
const cronPresets = document.getElementById('cron-presets');
const cronMinute = document.getElementById('cron-minute');
const cronHour = document.getElementById('cron-hour');
const cronDay = document.getElementById('cron-day');
const cronMonth = document.getElementById('cron-month');
const cronWeekday = document.getElementById('cron-weekday');
const cronOutput = document.getElementById('cron-output');
const cronMessage = document.getElementById('cron-message');
const cronCommand = document.getElementById('cron-command');
const starDesc = document.getElementById('label-star-description');
const copyCronBtn = document.getElementById('copy-cron');
const copyCommandBtn = document.getElementById('copy-command');

const errorFields = {
    minute: document.getElementById('error-minute'),
    hour: document.getElementById('error-hour'),
    day: document.getElementById('error-day'),
    month: document.getElementById('error-month'),
    weekday: document.getElementById('error-weekday')
};

function updateLanguage() {
    const lang = langSwitcher.value;
    const t = translations[lang];
    document.getElementById('cron-title').textContent = t.title;
    document.getElementById('label-presets').textContent = t.labelPreset;
    document.getElementById('label-minute').textContent = t.labelMinute;
    document.getElementById('label-hour').textContent = t.labelHour;
    document.getElementById('label-day').textContent = t.labelDay;
    document.getElementById('label-month').textContent = t.labelMonth;
    document.getElementById('label-weekday').textContent = t.labelWeekday;
    document.getElementById('label-output').textContent = t.labelOutput;
    document.getElementById('label-message').textContent = t.labelMessage;
    document.getElementById('label-command').textContent = t.labelCommand;
    starDesc.textContent = t.starDescription;
    copyCronBtn.textContent = t.copyCron;
    copyCommandBtn.textContent = t.copyCommand;
}

function validateInput(value, min, max){
    if(value==='*'||value==='') return {valid:true,val:'*',msg:''};
    if(/^(\d+|\d+(,\d+)*|\*\/\d+|\d+-\d+)$/.test(value)){
        const parts=value.split(',');
        for(let p of parts){
            if(p.includes('-')){
                const [start,end]=p.split('-').map(Number);
                if(start<min||end>max) return {valid:false,val:value,msg:translations[langSwitcher.value].errorMsg};
            } else if(p.includes('*/')){
                const n = Number(p.split('/')[1]);
                if(isNaN(n)) return {valid:false,val:value,msg:translations[langSwitcher.value].errorMsg};
            } else{
                const n = Number(p);
                if(isNaN(n)||n<min||n>max) return {valid:false,val:value,msg:translations[langSwitcher.value].errorMsg};
            }
        }
        return {valid:true,val:value,msg:''};
    }
    return {valid:false,val:value,msg:translations[langSwitcher.value].errorMsg};
}

function updateCron(){
    const presetValue = cronPresets.value;
    const fields = [
        {el: cronMinute, obj: validateInput(cronMinute.value,0,59), error: errorFields.minute},
        {el: cronHour, obj: validateInput(cronHour.value,0,23), error: errorFields.hour},
        {el: cronDay, obj: validateInput(cronDay.value,1,31), error: errorFields.day},
        {el: cronMonth, obj: validateInput(cronMonth.value,1,12), error: errorFields.month},
        {el: cronWeekday, obj: validateInput(cronWeekday.value,0,6), error: errorFields.weekday}
    ];

    let error = false;
    for(const f of fields){
        f.el.style.borderColor = f.obj.valid ? '#4B5563' : 'red';
        if(!f.obj.valid){
            f.error.textContent = f.obj.msg;
            f.error.classList.remove('hidden');
            error=true;
        } else {
            f.error.classList.add('hidden');
        }
    }

    if(presetValue!=='custom'&&presetValue!==''){
        const parts=presetValue.split(' ');
        if(parts.length===5){
            if(cronMinute.value!==parts[0]||cronHour.value!==parts[1]||cronDay.value!==parts[2]||cronMonth.value!==parts[3]||cronWeekday.value!==parts[4]){
                cronPresets.value='custom';
            }
        }
    }

    if(error){
        cronOutput.value = translations[langSwitcher.value].errorText;
        cronCommand.value = translations[langSwitcher.value].errorText;
        return;
    }

    let [minute,hour,day,month,weekday]=fields.map(f=>f.obj.val);

    if(presetValue && presetValue!=='custom'){
        const parts = presetValue.split(' ');
        if(parts.length===5){
            [minute,hour,day,month,weekday]=parts;
        }
    }

    cronMinute.value = minute;
    cronHour.value = hour;
    cronDay.value = day;
    cronMonth.value = month;
    cronWeekday.value = weekday;

    cronOutput.value = `${minute} ${hour} ${day} ${month} ${weekday}`;
    const channelPlaceholder="#kanal";
    const message = cronMessage.value.replace(/\n/g,'|');
    cronCommand.value = `/pridat_cron cron_vyraz="${cronOutput.value}" channel=${channelPlaceholder} zprava="${message}"`;
}

cronPresets.addEventListener('change', updateCron);
[cronMinute,cronHour,cronDay,cronMonth,cronWeekday].forEach(el=>el.addEventListener('input',updateCron));
cronMessage.addEventListener('input', updateCron);

copyCronBtn.addEventListener('click',()=>{cronOutput.select();document.execCommand('copy');});
copyCommandBtn.addEventListener('click',()=>{cronCommand.select();document.execCommand('copy');});
langSwitcher.addEventListener('change',()=>{updateLanguage();updateCron();});

updateLanguage();
updateCron();
</script>

</body>
</html>
