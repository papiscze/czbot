<!DOCTYPE html>
<html lang="cs">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CZBOT - Statistiky Bota</title>
    
    <link href="templatemo-nexus-style.css" rel="stylesheet">
    <link href="module-styles.css" rel="stylesheet"> 
    
    </head>
<body id="top"> 

    <div class="cyber-bg">
        <div class="cyber-gradient"></div>
        <div class="matrix-rain" id="matrixRain"></div>
    </div>
    <div class="scanlines"></div>
    <div class="noise-overlay"></div>
    <nav>
        <div class="nav-container">
            <a href="index.html" class="logo">CZbot</a>
            
            <ul class="nav-links">
                <li><a href="commands.html">P≈ô√≠kazy</a></li>

                <li class="dropdown">
                    <a href="#" class="dropdown-toggle">Moduly ‚ñæ</a>
                    <ul class="dropdown-menu">
                        <li><a href="modules/auditlogger.html">Auditlogger</a></li>
                        <li><a href="modules/audio_stream.html">Audio Stream</a></li>
                        <li><a href="modules/autopublish.html">Automatick√© publikov√°n√≠ zpr√°v z kan√°l≈Ø ozn√°men√≠</a></li>
                        <li><a href="modules/autorole.html">Autorole, Ovƒõ≈ôov√°n√≠ u≈æivatel≈Ø a Reakƒçn√≠ role</a></li>
                        <li><a href="modules/basic_user_commands.html">Bƒõ≈æn√© u≈æivatelsk√© a z√°bavn√© p≈ô√≠kazy</a></li>
                        <li><a href="modules/basic_mod_commands.html">Bƒõ≈æn√© moder√°torsk√© p≈ô√≠kazy</a></li>
                        <li><a href="modules/bot_localization.html">Bot localization and Language Settings</a></li>
                        <li><a href="modules/modules/crossban.html">Crossban</a></li>
                        <li><a href="modules/temp_voice.html">Doƒçasn√© hlasov√© kan√°ly</a></li>
                        <li><a href="modules/giveaway.html">Giveaway(e)</a></li>
                        <li><a href="modules/birthdays.html">Narozeniny</a></li>
                        <li><a href="modules/patreon.html">Patreon</a></li>
                        <li><a href="modules/counting.html">Poƒç√≠t√°n√≠</a></li>
                        <li><a href="modules/advanced_schedules.html">Pokroƒçil√© pl√°novan√© zpr√°vy</a></li>
                        <li><a href="modules/reactions.html">Reakce smajl√≠ky na zpr√°vy</a></li>
                        <li><a href="modules/reputation.html">Reputace</a></li>
                        <li><a href="modules/rss_reader.html">RSS ƒåteƒçka</a></li>
                        <li><a href="modules/scam_prevence.html">Scam Prevence</a></li>
                        <li><a href="modules/schedules.html">Schedules ‚Äê Pl√°novan√© zpr√°vy</a></li>
                        <li><a href="modules/stats.html">Statistiky serveru</a></li>
                        <li><a href="modules/holidays.html">Sv√°tky (CZ SK)</a></li>
                        <li><a href="modules/feedback.html">Syst√©m zpƒõtn√© vazby a n√°vrh≈Ø</a></li>
                        <li><a href="modules/tickets.html">Tikety</a></li>
                        <li><a href="modules/translate.html">Translate modul</a></li>
                        <li><a href="modules/threads.html">Tvorba vl√°ken na zpr√°vy</a></li>
                        <li><a href="modules/welcome_leave.html">Uv√≠tac√≠ a odchodov√© zpr√°vy (Welcome Leave)</a></li>
                        <li><a href="modules/vote.html">Vote ‚Äê Hlasov√°n√≠</a></li>
                        <li><a href="modules/watermark.html">Vodoznak s vlastn√≠m textem na obr√°zky</a></li>
                        <li><a href="modules/xp.html">XP syst√©m a √∫rovnƒõ</a></li>
                        <li><a href="modules/backup.html">Z√°lohov√°n√≠ a Obnova Server≈Ø</a></li>
                        <li><a href="modules/confessions.html">Zpovƒõdi (Anonymn√≠ Zpr√°vy)</a></li>
                    </ul>
                </li>

                <li class="dropdown">
                    <a href="#" class="dropdown-toggle">N√°stroje ‚ñæ</a>
                    <ul class="dropdown-menu">
                        <li><a href="crongenerator.html">Cron Gener√°tor</a></li>
                        <li><a href="embedgenerator.html">Embed Gener√°tor</a></li>
                        <li><a href="https://github.com/users/papiscze/projects/9">Roadmapa</a></li>
                        <li><a href="stats.html">Statistiky bota</a></li>
                    </ul>
                </li>

                <li><a href="warns.html">Moder√°torsk√© z√°znamy</a></li>
                <li><a href="https://rs422cznas.myds.me:5038/stats/">Statistiky serveru</a></li>
                <li><a href="privacy.html">GDPR / ToS</a></li>
            </ul>

            <div class="nav-bottom">
                <a href="https://discord.com/oauth2/authorize?client_id=902877191086420008&permissions=8&scope=bot%20applications.commands" class="cyber-button">Pozvat bota</a>
            </div>

            <button class="mobile-menu-button" id="mobileMenuBtn">
                <div class="hamburger">
                    <span></span>
                    <span></span>
                    <span></span>
                </div>
            </button>
        </div>
    </nav>
    <div class="mobile-menu-overlay" id="mobileMenuOverlay"></div>
    
    <div class="mobile-menu" id="mobileMenu">
        <div class="mobile-menu-header">
            <a href="index.html" class="mobile-menu-logo">CZbot</a>
            <button class="mobile-menu-close" id="mobileMenuClose">‚úï</button>
        </div>
        <div class="mobile-menu-cta">
            <a href="https://discord.com/oauth2/authorize?client_id=902877191086420008&permissions=8&scope=bot%20applications.commands" class="cyber-button">P≈ôidat bota</a>
        </div>
        <nav class="mobile-menu-nav">
            <ul>
                <li><a href="commands.html">P≈ô√≠kazy</a></li>

                <li class="dropdown">
                    <a href="#" class="dropdown-toggle">N√°stroje ‚ñæ</a>
                    <ul class="dropdown-menu">
                        <li><a href="crongenerator.html">Cron Gener√°tor</a></li>
                        <li><a href="embedgenerator.html">Embed Gener√°tor</a></li>
                        <li><a href="https://github.com/users/papiscze/projects/9">Roadmapa</a></li>
                        <li><a href="stats.html">Statistiky bota</a></li>
                    </ul>
                </li>

                <li><a href="warns.html">Moder√°torsk√© z√°znamy</a></li>
                <li><a href="https://rs422cznas.myds.me:5038/stats/">Statistiky serveru</a></li>
                <li><a href="privacy.html">GDPR / ToS</a></li>

                <li class="dropdown">
                    <a href="#" class="dropdown-toggle">Moduly ‚ñæ</a>
                    <ul class="dropdown-menu">
                        <li><a href="modules/auditlogger.html">Auditlogger</a></li>
                        <li><a href="modules/audio_stream.html">Audio Stream</a></li>
                        <li><a href="modules/autopublish.html">Automatick√© publikov√°n√≠ zpr√°v z kan√°l≈Ø ozn√°men√≠</a></li>
                        <li><a href="modules/autorole.html">Autorole, Ovƒõ≈ôov√°n√≠ u≈æivatel≈Ø a Reakƒçn√≠ role</a></li>
                        <li><a href="modules/basic_user_commands.html">Bƒõ≈æn√© u≈æivatelsk√© a z√°bavn√© p≈ô√≠kazy</a></li>
                        <li><a href="modules/basic_mod_commands.html">Bƒõ≈æn√© moder√°torsk√© p≈ô√≠kazy</a></li>
                        <li><a href="modules/bot_localization.html">Bot localization and Language Settings</a></li>
                        <li><a href="modules/modules/crossban.html">Crossban</a></li>
                        <li><a href="modules/temp_voice.html">Doƒçasn√© hlasov√© kan√°ly</a></li>
                        <li><a href="modules/giveaway.html">Giveaway(e)</a></li>
                        <li><a href="modules/birthdays.html">Narozeniny</a></li>
                        <li><a href="modules/patreon.html">Patreon</a></li>
                        <li><a href="modules/counting.html">Poƒç√≠t√°n√≠</a></li>
                        <li><a href="modules/advanced_schedules.html">Pokroƒçil√© pl√°novan√© zpr√°vy</a></li>
                        <li><a href="modules/reactions.html">Reakce smajl√≠ky na zpr√°vy</a></li>
                        <li><a href="modules/reputation.html">Reputace</a></li>
                        <li><a href="modules/rss_reader.html">RSS ƒåteƒçka</a></li>
                        <li><a href="modules/scam_prevence.html">Scam Prevence</a></li>
                        <li><a href="modules/schedules.html">Schedules ‚Äê Pl√°novan√© zpr√°vy</a></li>
                        <li><a href="modules/stats.html">Statistiky serveru</a></li>
                        <li><a href="modules/holidays.html">Sv√°tky (CZ SK)</a></li>
                        <li><a href="modules/feedback.html">Syst√©m zpƒõtn√© vazby a n√°vrh≈Ø</a></li>
                        <li><a href="modules/tickets.html">Tikety</a></li>
                        <li><a href="modules/translate.html">Translate modul</a></li>
                        <li><a href="modules/threads.html">Tvorba vl√°ken na zpr√°vy</a></li>
                        <li><a href="modules/welcome_leave.html">Uv√≠tac√≠ a odchodov√© zpr√°vy (Welcome Leave)</a></li>
                        <li><a href="modules/vote.html">Vote ‚Äê Hlasov√°n√≠</a></li>
                        <li><a href="modules/watermark.html">Vodoznak s vlastn√≠m textem na obr√°zky</a></li>
                        <li><a href="modules/xp.html">XP syst√©m a √∫rovnƒõ</a></li>
                        <li><a href="modules/backup.html">Z√°lohov√°n√≠ a Obnova Server≈Ø</a></li>
                        <li><a href="modules/confessions.html">Zpovƒõdi (Anonymn√≠ Zpr√°vy)</a></li>
                    </ul>
                </li>           
            </ul>
        </nav>
    </div>
    </nav>
    <div class="mobile-menu-overlay" id="mobileMenuOverlay"></div>
    <div class="mobile-menu" id="mobileMenu">
        </div>
    <div class="content-section">
        <div class="content-container">

            <h1 class="page-title">Statistiky a Status Bota</h1>
            <p class="page-subtitle">Aktu√°ln√≠ p≈ôehled provozu a v√Ωkonu Discord Bota <strong>CZbot.</strong></p>

            <div class="warn-box" id="warnBox" style="display:none;"></div> 

            <div class="stats-grid">
                
                <div class="stat-card">
                    <h4>Status Bota</h4>
                    <span class="value" id="statStatus">Naƒç√≠t√°m...</span> 
                </div>

                <div class="stat-card">
                    <h4>Poƒçet Server≈Ø</h4>
                    <span class="value" id="statServers">Naƒç√≠t√°m...</span>
                </div>
                
                <div class="stat-card">
                    <h4>Uptime</h4>
                    <span class="value" id="statUptime">Naƒç√≠t√°m...</span>
                </div>
                
                <div class="stat-card">
                    <h4>Vyu≈æit√≠ CPU</h4>
                    <span class="value" id="statCPU">Naƒç√≠t√°m...</span>
                </div>

                <div class="stat-card">
                    <h4>Vyu≈æit√≠ RAM</h4>
                    <span class="value" id="statRAM">Naƒç√≠t√°m...</span>
                </div>
                
                <div class="stat-card">
                    <h4>API a DB Status</h4>
                    <span class="value" id="statAPI">Naƒç√≠t√°m...</span> 
                </div>
                
            </div>

            <div class="chart-container">
                <h3>Stav Modul≈Ø (Cogs)</h3>
                <ul class="cogs-list" id="cogsList">
                    <li>Naƒç√≠t√°m moduly...</li> 
                </ul>
            </div>
            
            <div class="chart-container">
                <h3>Historie Ping a Vyu≈æit√≠ (Placeholder)</h3>
                <p>Dynamick√© grafy budou implementov√°ny pozdƒõji. Zde se budou zobrazovat historick√© metriky.</p>
                <canvas id="pingChart" width="400" height="150" aria-label="Graf historie ping"></canvas>
            </div>
            
        </div>
    </div>
    <footer class="footer">
        <div class="footer-content">
            <div class="footer-links">
                <a href="https://github.com/papiscze/czbot">GitHub</a>
                <span class="footer-separator">‚Ä¢</span>
                <a href="https://discord.gg/hk6PdtVxbm">Support Server</a>
                <span class="footer-separator">‚Ä¢</span>
                <a href="https://github.com/papiscze/czbot/wiki">GitHub dokumentace</a>
                <span class="footer-separator">‚Ä¢</span>
                <a href="mailto:admin@ofpmafia.eu">Kontakt</a>
            </div>
            <div class="footer-bottom">
                <p>&copy; 2025 CZbot. Verze webu 1.0. V≈°echna pr√°va vyhrazena</p>
                <p class="footer-credit">≈†ablona inspirov√°na <a href="https://templatemo.com" target="_blank" rel="noopener nofollow">TemplateMo</a></p>
            </div>
        </div>
    </footer>

    <script src="templatemo-nexus-scripts.js"></script>
    
    <script>
        const cogs_to_load = ["Audio Streaming","Administr√°torsk√Ω cog","Administr√°torsk√Ω 2 cog","Crossban","Pokroƒçil√© pl√°novan√© zpr√°vy","Auditlogger","Automatick√© publikace zpr√°v","Automatick√© role","Doƒçasn√© hlasov√© kan√°ly","Giveaway","Hlasov√°n√≠","Kolo ≈°tƒõst√≠","Lokalizace","Moder√°torsk√© p≈ô√≠kazy","Narozeniny","Ovƒõ≈ôov√°n√≠ a Reakƒçn√≠ role","Patreon","Poƒç√≠t√°n√≠","P≈ôeklad","RAID ochrana","Reputace","RSS ƒçteƒçka", "Z√°lohov√°n√≠ server≈Ø", "Pl√°novan√© zpr√°vy","Scam ochrana","Statistiky","Sv√°tky","Tikety","Uv√≠tac√≠/odchodov√© zpr√°vy","U≈æivatelsk√© p≈ô√≠kazy","Vl√°kna a reakce na zpr√°vy","Vodoznaky","XP √∫rovnƒõ","AI cog", "Zpovƒõdi"];

        async function fetchStatus() {
            // Z√≠sk√°n√≠ element≈Ø z HTML
            const statStatus = document.getElementById("statStatus");
            const statServers = document.getElementById("statServers");
            const statUptime = document.getElementById("statUptime");
            const statCPU = document.getElementById("statCPU");
            const statRAM = document.getElementById("statRAM");
            const statAPI = document.getElementById("statAPI");
            const cogsList = document.getElementById("cogsList");
            const warnBox = document.getElementById("warnBox");

            // üü† sem napi≈° vlastn√≠ status zpr√°vu (pokud nechce≈° ≈æ√°dnou, nech to pr√°zdn√©)
            const warn_message = "ƒå√°steƒçnƒõ zhor≈°en√° dostupnost API"; 

            // zobrazen√≠ nebo skryt√≠ varovn√©ho boxu
            if (warn_message && warn_message.trim() !== "") {
                warnBox.textContent = "üö® UPOZORNƒöN√ç: " + warn_message; // P≈ôid√°me kybernetick√Ω prefix
                warnBox.classList.add("warn-box-active"); 
                warnBox.style.display = "block";
            } else {
                warnBox.classList.remove("warn-box-active");
                warnBox.style.display = "none";
            }

            // Nastaven√≠ poƒç√°teƒçn√≠ch hodnot p≈ôi naƒç√≠t√°n√≠
            [statStatus, statServers, statUptime, statCPU, statRAM, statAPI].forEach(el => el.textContent = "Naƒç√≠t√°m...");
            cogsList.innerHTML="<li>Naƒç√≠t√°m moduly...</li>";

            // Pomocn√° funkce pro vytvo≈ôen√≠ polo≈æky Cogs
            function addCogItem(name, status, cls=""){ 
                const li = document.createElement("li"); 
                // Stylizace pro seznam modul≈Ø
                li.innerHTML = `<span class="cog-label">${name}</span><span class="cog-value ${cls}">${status}</span>`; 
                return li;
            }

            try {
                const res = await fetch("https://rs422cznas.myds.me:5038/status");
                const data = await res.json();

                const uptime_sec = data.uptime_seconds || 0;
                const hours = Math.floor(uptime_sec/3600);
                const minutes = Math.floor((uptime_sec%3600)/60);
                const seconds = Math.floor(uptime_sec%60);
                const uptime_str = `${hours}h ${minutes}m ${seconds}s`;
                
                // 1. Vlo≈æen√≠ dat do karet
                // Status bota
                statStatus.textContent = data.bot_status.toUpperCase();
                statStatus.className = data.bot_status === "online" ? "value status-online" : "value status-offline";
                
                // Ostatn√≠ metriky
                statServers.textContent = data.guilds.toLocaleString('cs-CZ');
                statUptime.textContent = uptime_str;
                statCPU.textContent = `${data.cpu_percent} %`;
                statRAM.textContent = `${data.ram_mb} MB`;
                
                // API a DB status
                statAPI.textContent = data.api_db_status === "OK" ? "OK" : "PROBL√âM";
                statAPI.className = data.api_db_status === "OK" ? "value status-ok" : "value status-err";

                // 2. Vlo≈æen√≠ stavu modul≈Ø (Cogs)
                cogsList.innerHTML="";
                const sortedCogs = Object.entries(data.cogs).sort((a,b) => a[0].localeCompare(b[0], 'cs'));
                
                for(const [name,status] of sortedCogs){
                    let cls="";
                    if(status==="Funkƒçn√≠") cls="status-ok";
                    else if(status.toLowerCase().includes("chyba") || status.toLowerCase().includes("error") || status.toLowerCase().includes("offline")) cls="status-err";
                    else cls="status-warn"; // Pro jin√© stavy
                    
                    cogsList.appendChild(addCogItem(name, status, cls));
                }
                
            } catch(err){
                // 3. Zpracov√°n√≠ chyby
                console.error("Chyba p≈ôi naƒç√≠t√°n√≠ statusu API:", err);
                
                // Nastaven√≠ chybov√Ωch hodnot pro karty
                statStatus.textContent = "OFFLINE";
                statStatus.className = "value status-err"; 
                statServers.textContent = "-";
                statUptime.textContent = "-";
                statCPU.textContent = "- %";
                statRAM.textContent = "- MB";
                statAPI.textContent = "NEDOSTUPN√â";
                statAPI.className = "value status-err";
                
                // Nastaven√≠ chybov√Ωch hodnot pro Cogs
                cogsList.innerHTML="";
                cogs_to_load.forEach(label => {
                    cogsList.appendChild(addCogItem(label, "Nedostupn√©", "status-err"));
                });
            }
        }

        // Spu≈°tƒõn√≠ naƒç√≠t√°n√≠ statusu
        fetchStatus();
        // Nastaven√≠ automatick√©ho refresh 
        setInterval(fetchStatus, 30000); // Obnov√≠ data ka≈æd√Ωch 30 sekund
    </script>

</body>
</html>
